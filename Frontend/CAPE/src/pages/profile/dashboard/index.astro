---
import Layout from "@layouts/LayoutVertical.astro";
import PersonalDataComponent from "@components/PersonalDataComponent.tsx";

import { Avatar } from "@nextui-org/react";

import ExamHistoryComponentA from "@components/ExamHistoryComponentA.tsx";
import { userSettings } from "../../../store.ts";
---

<Layout title="Dashboard">
  <main class="h-screen bg-gray-50 p-8">
    <header
      class="flex justify-between items-center bg-white p-5 rounded-lg shadow-sm mb-8"
    >
      <div class="flex items-center space-x-2">
        <label for="sort" class="text-gray-600 font-medium">Sort:</label>
        <select
          id="sort"
          class="border border-gray-300 rounded-lg px-3 py-1 focus:outline-none focus:ring-2 focus:ring-blue-400"
        >
          <option>Last Week</option>
          <option>Last Month</option>
          <option>All Time</option>
        </select>
      </div>
      <div class="flex items-center space-x-6">
        <button class="p-2 rounded-full hover:bg-gray-100 transition">
          <svg
            xmlns="http://www.w3.org/2000/svg"
            class="h-6 w-6 text-blue-500"
            fill="none"
            viewBox="0 0 24 24"
            stroke="currentColor"
          >
            <path
              stroke-linecap="round"
              stroke-linejoin="round"
              stroke-width="2"
              d="M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.5V11a6.002 6.002 0 00-4-5.659V4a2 2 0 10-4 0v1.341C7.67 7.165 6 9.388 6 12v2.5c0 .403-.243.772-.595.895L4 17h5"
            ></path>
          </svg>
        </button>
        <Avatar
          showFallback
          src={"https://ui-avatars.com/api/?background=random&name=" +
            userSettings.get("username")}
        />
      </div>
    </header>

    <PersonalDataComponent client:only />

    <div class="bg-white shadow-md rounded-xl p-6 mb-8">
      <h2 class="text-lg font-semibold text-gray-700 mb-4">Exam Statistics</h2>
      <div class="grid grid-cols-3 gap-4">
        <div>
          <h3 class="text-md font-semibold text-gray-600 mb-2">Performance</h3>
          <canvas id="performanceChart" style="width: 100%; height: 150px;"
          ></canvas>
        </div>
        <div>
          <h3 class="text-md font-semibold text-gray-600 mb-2">
            Answers History
          </h3>
          <canvas id="accurateAnswersChart" style="width: 100%; height: 150px;"
          ></canvas>
        </div>
        <div>
          <h3 class="text-md font-semibold text-gray-600 mb-2">
            Wrong Answers
          </h3>
          <canvas id="wrongAnswersChart" style="width: 100%; height: 150px;"
          ></canvas>
        </div>
      </div>
    </div>

    <ExamHistoryComponentA client:only />

    <div class="grid grid-cols-2 gap-4 mb-8">
      <div class="bg-white shadow-md rounded-xl p-6">
        <h2 class="text-lg font-semibold text-gray-700 mb-4">
          Study Materials
        </h2>
        <div class="grid grid-cols-2 gap-4">
          <div class="bg-gray-100 p-4 rounded-lg">
            <h3 class="font-semibold">Mathematics</h3>
            <img
              src="https://via.placeholder.com/150"
              alt="Math"
              class="mb-2 w-full h-32 object-cover rounded-md"
            />
            <p>Algebra, Geometry, Calculus.</p>
          </div>
          <div class="bg-gray-100 p-4 rounded-lg">
            <h3 class="font-semibold">Science</h3>
            <img
              src="https://via.placeholder.com/150"
              alt="Science"
              class="mb-2 w-full h-32 object-cover rounded-md"
            />
            <p>Physics, Chemistry, Biology.</p>
          </div>
          <div class="bg-gray-100 p-4 rounded-lg">
            <h3 class="font-semibold">History</h3>
            <img
              src="https://via.placeholder.com/150"
              alt="History"
              class="mb-2 w-full h-32 object-cover rounded-md"
            />
            <p>World History, Indian History.</p>
          </div>
          <div class="bg-gray-100 p-4 rounded-lg">
            <h3 class="font-semibold">Languages</h3>
            <img
              src="https://via.placeholder.com/150"
              alt="Languages"
              class="mb-2 w-full h-32 object-cover rounded-md"
            />
            <p>English, Hindi, French.</p>
          </div>
        </div>
      </div>
      <div class="bg-white shadow-md rounded-xl p-6">
        <h2 class="text-lg font-semibold text-gray-700 mb-4">
          Further Studies
        </h2>
        <div class="grid grid-cols-2 gap-4">
          <div class="bg-gray-100 p-4 rounded-lg">
            <h3 class="font-semibold">Advanced Math</h3>
            <img
              src="https://via.placeholder.com/150"
              alt="Advanced Math"
              class="mb-2 w-full h-32 object-cover rounded-md"
            />
          </div>
          <div class="bg-gray-100 p-4 rounded-lg">
            <h3 class="font-semibold">Physics II</h3>
            <img
              src="https://via.placeholder.com/150"
              alt="Physics II"
              class="mb-2 w-full h-32 object-cover rounded-md"
            />
          </div>
        </div>
      </div>
    </div>

    <footer class="mt-10 p-4 text-center text-gray-600">
      <p>&copy; 2024 Ritik Mishra. All rights reserved.</p>
    </footer>
  </main>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

  <script>
    document.addEventListener("DOMContentLoaded", function () {
      const performanceData = [75, 85, 95, 70, 80];
      const accurateAnswersData = [60, 40, 10];
      const wrongAnswersData = [10, 15, 5];

      // Bar Chart for Performance
      const performanceCtx = document
        .getElementById("performanceChart")
        .getContext("2d");
      new Chart(performanceCtx, {
        type: "bar",
        data: {
          labels: ["Exam 1", "Exam 2", "Exam 3", "Exam 4", "Exam 5"],
          datasets: [
            {
              label: "Scores",
              data: performanceData,
              backgroundColor: "rgba(54, 162, 235, 0.6)",
            },
          ],
        },
        options: {
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: "Scores",
              },
            },
          },
        },
      });

      // Pie Chart for Accurate Answers
      const accurateAnswersCtx = document
        .getElementById("accurateAnswersChart")
        .getContext("2d");
      new Chart(accurateAnswersCtx, {
        type: "pie",
        data: {
          labels: ["Correct", "Incorrect", "Unaatempted"],
          datasets: [
            {
              data: accurateAnswersData,
              backgroundColor: [
                "rgba(75, 192, 192, 0.6)",
                "rgba(255, 99, 132, 0.6)",
                "rgba(120, 99, 100, 0.6)",
              ],
            },
          ],
        },
      });

      // Line Chart for Wrong Answers
      const wrongAnswersCtx = document
        .getElementById("wrongAnswersChart")
        .getContext("2d");
      new Chart(wrongAnswersCtx, {
        type: "line",
        data: {
          labels: ["Exam 1", "Exam 2", "Exam 3"],
          datasets: [
            {
              label: "Wrong Answers",
              data: wrongAnswersData,
              borderColor: "rgba(255, 206, 86, 1)",
              fill: false,
            },
          ],
        },
        options: {
          scales: {
            y: {
              beginAtZero: true,
              title: {
                display: true,
                text: "Wrong Answers",
              },
            },
          },
        },
      });
    });
  </script>
</Layout>
